var wp;(wp||={}).customizeWidgets=(()=>{var Oo=Object.create;var pt=Object.defineProperty;var Fo=Object.getOwnPropertyDescriptor;var Do=Object.getOwnPropertyNames;var Po=Object.getPrototypeOf,jo=Object.prototype.hasOwnProperty;var p=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),$t=(t,e)=>{for(var r in e)pt(t,r,{get:e[r],enumerable:!0})},ke=(t,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Do(e))!jo.call(t,s)&&s!==r&&pt(t,s,{get:()=>e[s],enumerable:!(o=Fo(e,s))||o.enumerable});return t};var a=(t,e,r)=>(r=t!=null?Oo(Po(t)):{},ke(e||!t||!t.__esModule?pt(r,"default",{value:t,enumerable:!0}):r,t)),Ho=t=>ke(pt({},"__esModule",{value:!0}),t);var w=p((ba,_e)=>{_e.exports=window.wp.element});var Xt=p((ya,xe)=>{xe.exports=window.wp.blockLibrary});var G=p((va,Ce)=>{Ce.exports=window.wp.widgets});var Yt=p((Sa,Ie)=>{Ie.exports=window.wp.blocks});var b=p((ka,Be)=>{Be.exports=window.wp.data});var rt=p((_a,We)=>{We.exports=window.wp.preferences});var R=p((xa,Ee)=>{Ee.exports=window.wp.components});var E=p((Ca,ze)=>{ze.exports=window.wp.i18n});var z=p((Ia,Ae)=>{Ae.exports=window.wp.blockEditor});var K=p((Ba,Te)=>{Te.exports=window.wp.compose});var ot=p((Wa,Le)=>{Le.exports=window.wp.hooks});var c=p((Ea,Me)=>{Me.exports=window.ReactJSXRuntime});var He=p((Ta,je)=>{je.exports=window.wp.coreData});var Jt=p((La,Ve)=>{Ve.exports=window.wp.mediaUtils});var q=p((Na,Je)=>{Je.exports=window.wp.keycodes});var V=p((Oa,Qe)=>{Qe.exports=window.wp.primitives});var at=p((ss,nr)=>{nr.exports=window.wp.keyboardShortcuts});var Wr=p((Cs,Br)=>{"use strict";Br.exports=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var o,s,i;if(Array.isArray(e)){if(o=e.length,o!=r.length)return!1;for(s=o;s--!==0;)if(!t(e[s],r[s]))return!1;return!0}if(e instanceof Map&&r instanceof Map){if(e.size!==r.size)return!1;for(s of e.entries())if(!r.has(s[0]))return!1;for(s of e.entries())if(!t(s[1],r.get(s[0])))return!1;return!0}if(e instanceof Set&&r instanceof Set){if(e.size!==r.size)return!1;for(s of e.entries())if(!r.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(r)){if(o=e.length,o!=r.length)return!1;for(s=o;s--!==0;)if(e[s]!==r[s])return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(i=Object.keys(e),o=i.length,o!==Object.keys(r).length)return!1;for(s=o;s--!==0;)if(!Object.prototype.hasOwnProperty.call(r,i[s]))return!1;for(s=o;s--!==0;){var d=i[s];if(!t(e[d],r[d]))return!1}return!0}return e!==e&&r!==r}});var zr=p((Is,Er)=>{Er.exports=window.wp.isShallowEqual});var jr=p((Ms,Pr)=>{Pr.exports=window.wp.privateApis});var _o=p((hi,ko)=>{ko.exports=window.wp.dom});var ga={};$t(ga,{initialize:()=>ha,store:()=>x});var Vt=a(w()),Ut=a(Xt()),et=a(G()),Gt=a(Yt()),ve=a(b()),No=a(rt());var D=a(w()),Pt=a(R());var Re=a(w()),Zt=a(E()),Ne=a(R()),Oe=a(z()),Fe=a(K()),De=a(ot()),ht=a(c());function Vo({text:t,children:e}){let r=(0,Fe.useCopyToClipboard)(t);return(0,ht.jsx)(Ne.Button,{size:"compact",variant:"secondary",ref:r,children:e})}var Pe=class extends Re.Component{constructor(){super(...arguments),this.state={error:null}}componentDidCatch(t){this.setState({error:t}),(0,De.doAction)("editor.ErrorBoundary.errorLogged",t)}render(){let{error:t}=this.state;return t?(0,ht.jsx)(Oe.Warning,{className:"customize-widgets-error-boundary",actions:[(0,ht.jsx)(Vo,{text:t.stack,children:(0,Zt.__)("Copy Error")},"copy-error")],children:(0,Zt.__)("The editor has encountered an unexpected error.")}):this.props.children}};var ro=a(K()),oo=a(He()),ao=a(b()),Ot=a(w()),L=a(z()),so=a(Jt()),io=a(rt()),lo=a(Xt());var Ue=a(w()),Ge=a(E()),Ke=a(R()),qe=a(b()),$e=a(z()),Xe=a(c());function Uo({inspector:t,closeMenu:e,...r}){let o=(0,qe.useSelect)(i=>i($e.store).getSelectedBlockClientId(),[]),s=(0,Ue.useMemo)(()=>document.getElementById(`block-${o}`),[o]);return(0,Xe.jsx)(Ke.MenuItem,{onClick:()=>{t.open({returnFocusWhenClose:s}),e()},...r,children:(0,Ge.__)("Show more settings")})}var Ye=Uo;function Ze(t){var e,r,o="";if(typeof t=="string"||typeof t=="number")o+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(r=Ze(t[e]))&&(o&&(o+=" "),o+=r)}else for(r in t)t[r]&&(o&&(o+=" "),o+=r);return o}function Go(){for(var t,e,r=0,o="",s=arguments.length;r<s;r++)(t=arguments[r])&&(e=Ze(t))&&(o&&(o+=" "),o+=e);return o}var gt=Go;var zt=a(R()),xr=a(z()),X=a(w()),$=a(q()),O=a(E());var wt=a(V()),Qt=a(c()),te=(0,Qt.jsx)(wt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,Qt.jsx)(wt.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"})});var bt=a(V()),ee=a(c()),re=(0,ee.jsx)(bt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,ee.jsx)(bt.Path,{d:"M19.5 4.5h-7V6h4.44l-5.97 5.97 1.06 1.06L18 7.06v4.44h1.5v-7Zm-13 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-3H17v3a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h3V5.5h-3Z"})});var yt=a(V()),oe=a(c()),ae=(0,oe.jsx)(yt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,oe.jsx)(yt.Path,{d:"M13 19h-2v-2h2v2zm0-6h-2v-2h2v2zm0-6h-2V5h2v2z"})});var vt=a(V()),se=a(c()),ie=(0,se.jsx)(vt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,se.jsx)(vt.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})});var St=a(V()),de=a(c()),kt=(0,de.jsx)(St.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,de.jsx)(St.Path,{d:"M15.6 6.5l-1.1 1 2.9 3.3H8c-.9 0-1.7.3-2.3.9-1.4 1.5-1.4 4.2-1.4 5.6v.2h1.5v-.3c0-1.1 0-3.5 1-4.5.3-.3.7-.5 1.3-.5h9.2L14.5 15l1.1 1.1 4.6-4.6-4.6-5z"})});var _t=a(V()),le=a(c()),xt=(0,le.jsx)(_t.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,le.jsx)(_t.Path,{d:"M18.3 11.7c-.6-.6-1.4-.9-2.3-.9H6.7l2.9-3.3-1.1-1-4.5 5L8.5 16l1-1-2.7-2.7H16c.5 0 .9.2 1.3.5 1 1 1 3.4 1 4.5v.3h1.5v-.2c0-1.5 0-4.3-1.5-5.7z"})});var ue=a(E()),or=a(z()),ar=a(R()),sr=a(K()),ir=a(b());var Ct=a(b());var tr=a(b());function Ko(t=!1,e){switch(e.type){case"SET_IS_INSERTER_OPENED":return e.value}return t}var er=(0,tr.combineReducers)({blockInserterPanel:Ko});var ne={};$t(ne,{__experimentalGetInsertionPoint:()=>Xo,isInserterOpened:()=>$o});var qo={rootClientId:void 0,insertionIndex:void 0};function $o(t){return!!t.blockInserterPanel}function Xo(t){return typeof t.blockInserterPanel=="boolean"?qo:t.blockInserterPanel}var fe={};$t(fe,{setIsInserterOpened:()=>Yo});function Yo(t){return{type:"SET_IS_INSERTER_OPENED",value:t}}var rr="core/customize-widgets";var Zo={reducer:er,selectors:ne,actions:fe},x=(0,Ct.createReduxStore)(rr,Zo);(0,Ct.register)(x);var P=a(c());function dr({setIsOpened:t}){let e=(0,sr.useInstanceId)(dr,"customize-widget-layout__inserter-panel-title"),r=(0,ir.useSelect)(o=>o(x).__experimentalGetInsertionPoint(),[]);return(0,P.jsxs)("div",{className:"customize-widgets-layout__inserter-panel","aria-labelledby":e,children:[(0,P.jsxs)("div",{className:"customize-widgets-layout__inserter-panel-header",children:[(0,P.jsx)("h2",{id:e,className:"customize-widgets-layout__inserter-panel-header-title",children:(0,ue.__)("Add a block")}),(0,P.jsx)(ar.Button,{size:"small",icon:te,onClick:()=>t(!1),"aria-label":(0,ue.__)("Close inserter")})]}),(0,P.jsx)("div",{className:"customize-widgets-layout__inserter-panel-content",children:(0,P.jsx)(or.__experimentalLibrary,{rootClientId:r.rootClientId,__experimentalInsertionIndex:r.insertionIndex,showInserterHelpPanel:!0,onSelect:()=>t(!1)})})]})}var lr=dr;var A=a(R()),vr=a(w()),g=a(E());var Sr=a(q()),kr=a(at()),Et=a(rt());var wr=a(R()),N=a(E()),st=a(at()),Wt=a(b()),br=a(w());var C=a(E()),fr=[{keyCombination:{modifier:"primary",character:"b"},description:(0,C.__)("Make the selected text bold.")},{keyCombination:{modifier:"primary",character:"i"},description:(0,C.__)("Make the selected text italic.")},{keyCombination:{modifier:"primary",character:"k"},description:(0,C.__)("Convert the selected text into a link.")},{keyCombination:{modifier:"primaryShift",character:"k"},description:(0,C.__)("Remove a link.")},{keyCombination:{character:"[["},description:(0,C.__)("Insert a link to a post or page.")},{keyCombination:{modifier:"primary",character:"u"},description:(0,C.__)("Underline the selected text.")},{keyCombination:{modifier:"access",character:"d"},description:(0,C.__)("Strikethrough the selected text.")},{keyCombination:{modifier:"access",character:"x"},description:(0,C.__)("Make the selected text inline code.")},{keyCombination:{modifier:"access",character:"0"},aliases:[{modifier:"access",character:"7"}],description:(0,C.__)("Convert the current heading to a paragraph.")},{keyCombination:{modifier:"access",character:"1-6"},description:(0,C.__)("Convert the current paragraph or heading to a heading of level 1 to 6.")},{keyCombination:{modifier:"primaryShift",character:"SPACE"},description:(0,C.__)("Add non breaking space.")}];var mr=a(w()),It=a(q()),I=a(c());function ur({keyCombination:t,forceAriaLabel:e}){let r=t.modifier?It.displayShortcutList[t.modifier](t.character):t.character,o=t.modifier?It.shortcutAriaLabel[t.modifier](t.character):t.character;return(0,I.jsx)("kbd",{className:"customize-widgets-keyboard-shortcut-help-modal__shortcut-key-combination","aria-label":e||o,children:(Array.isArray(r)?r:[r]).map((s,i)=>s==="+"?(0,I.jsx)(mr.Fragment,{children:s},i):(0,I.jsx)("kbd",{className:"customize-widgets-keyboard-shortcut-help-modal__shortcut-key",children:s},i))})}function Jo({description:t,keyCombination:e,aliases:r=[],ariaLabel:o}){return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("div",{className:"customize-widgets-keyboard-shortcut-help-modal__shortcut-description",children:t}),(0,I.jsxs)("div",{className:"customize-widgets-keyboard-shortcut-help-modal__shortcut-term",children:[(0,I.jsx)(ur,{keyCombination:e,forceAriaLabel:o}),r.map((s,i)=>(0,I.jsx)(ur,{keyCombination:s,forceAriaLabel:o},i))]})]})}var Bt=Jo;var cr=a(b()),pr=a(at());var hr=a(c());function Qo({name:t}){let{keyCombination:e,description:r,aliases:o}=(0,cr.useSelect)(s=>{let{getShortcutKeyCombination:i,getShortcutDescription:d,getShortcutAliases:l}=s(pr.store);return{keyCombination:i(t),aliases:l(t),description:d(t)}},[t]);return e?(0,hr.jsx)(Bt,{keyCombination:e,description:r,aliases:o}):null}var gr=Qo;var k=a(c()),ta=({shortcuts:t})=>(0,k.jsx)("ul",{className:"customize-widgets-keyboard-shortcut-help-modal__shortcut-list",role:"list",children:t.map((e,r)=>(0,k.jsx)("li",{className:"customize-widgets-keyboard-shortcut-help-modal__shortcut",children:typeof e=="string"?(0,k.jsx)(gr,{name:e}):(0,k.jsx)(Bt,{...e})},r))}),ce=({title:t,shortcuts:e,className:r})=>(0,k.jsxs)("section",{className:gt("customize-widgets-keyboard-shortcut-help-modal__section",r),children:[!!t&&(0,k.jsx)("h2",{className:"customize-widgets-keyboard-shortcut-help-modal__section-title",children:t}),(0,k.jsx)(ta,{shortcuts:e})]}),me=({title:t,categoryName:e,additionalShortcuts:r=[]})=>{let o=(0,Wt.useSelect)(s=>s(st.store).getCategoryShortcuts(e),[e]);return(0,k.jsx)(ce,{title:t,shortcuts:o.concat(r)})};function yr({isModalActive:t,toggleModal:e}){let{registerShortcut:r}=(0,Wt.useDispatch)(st.store);return(0,br.useEffect)(()=>{r({name:"core/customize-widgets/keyboard-shortcuts",category:"main",description:(0,N.__)("Display these keyboard shortcuts."),keyCombination:{modifier:"access",character:"h"}})},[r]),(0,st.useShortcut)("core/customize-widgets/keyboard-shortcuts",e),t?(0,k.jsxs)(wr.Modal,{className:"customize-widgets-keyboard-shortcut-help-modal",title:(0,N.__)("Keyboard shortcuts"),onRequestClose:e,children:[(0,k.jsx)(ce,{className:"customize-widgets-keyboard-shortcut-help-modal__main-shortcuts",shortcuts:["core/customize-widgets/keyboard-shortcuts"]}),(0,k.jsx)(me,{title:(0,N.__)("Global shortcuts"),categoryName:"global"}),(0,k.jsx)(me,{title:(0,N.__)("Selection shortcuts"),categoryName:"selection"}),(0,k.jsx)(me,{title:(0,N.__)("Block shortcuts"),categoryName:"block",additionalShortcuts:[{keyCombination:{character:"/"},description:(0,N.__)("Change the block type after adding a new paragraph."),ariaLabel:(0,N.__)("Forward-slash")}]}),(0,k.jsx)(ce,{title:(0,N.__)("Text formatting"),shortcuts:fr})]}):null}var y=a(c());function _r(){let[t,e]=(0,vr.useState)(!1),r=()=>e(!t);return(0,kr.useShortcut)("core/customize-widgets/keyboard-shortcuts",r),(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(A.ToolbarDropdownMenu,{icon:ae,label:(0,g.__)("Options"),popoverProps:{placement:"bottom-end",className:"more-menu-dropdown__content"},toggleProps:{tooltipPosition:"bottom",size:"compact"},children:()=>(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(A.MenuGroup,{label:(0,g._x)("View","noun"),children:(0,y.jsx)(Et.PreferenceToggleMenuItem,{scope:"core/customize-widgets",name:"fixedToolbar",label:(0,g.__)("Top toolbar"),info:(0,g.__)("Access all block and document tools in a single place"),messageActivated:(0,g.__)("Top toolbar activated"),messageDeactivated:(0,g.__)("Top toolbar deactivated")})}),(0,y.jsxs)(A.MenuGroup,{label:(0,g.__)("Tools"),children:[(0,y.jsx)(A.MenuItem,{onClick:()=>{e(!0)},shortcut:Sr.displayShortcut.access("h"),children:(0,g.__)("Keyboard shortcuts")}),(0,y.jsx)(Et.PreferenceToggleMenuItem,{scope:"core/customize-widgets",name:"welcomeGuide",label:(0,g.__)("Welcome Guide")}),(0,y.jsxs)(A.MenuItem,{role:"menuitem",icon:re,href:(0,g.__)("https://wordpress.org/documentation/article/block-based-widgets-editor/"),target:"_blank",rel:"noopener noreferrer",children:[(0,g.__)("Help"),(0,y.jsx)(A.VisuallyHidden,{as:"span",children:(0,g.__)("(opens in a new tab)")})]})]}),(0,y.jsx)(A.MenuGroup,{label:(0,g.__)("Preferences"),children:(0,y.jsx)(Et.PreferenceToggleMenuItem,{scope:"core/customize-widgets",name:"keepCaretInsideBlock",label:(0,g.__)("Contain text cursor inside block"),info:(0,g.__)("Aids screen readers by stopping text caret from leaving blocks."),messageActivated:(0,g.__)("Contain text cursor inside block activated"),messageDeactivated:(0,g.__)("Contain text cursor inside block deactivated")})})]})}),(0,y.jsx)(yr,{isModalActive:t,toggleModal:r})]})}var B=a(c());function ea({sidebar:t,inserter:e,isInserterOpened:r,setIsInserterOpened:o,isFixedToolbarActive:s}){let[[i,d],l]=(0,X.useState)([t.hasUndo(),t.hasRedo()]),u=(0,$.isAppleOS)()?$.displayShortcut.primaryShift("z"):$.displayShortcut.primary("y");return(0,X.useEffect)(()=>t.subscribeHistory(()=>{l([t.hasUndo(),t.hasRedo()])}),[t]),(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("div",{className:gt("customize-widgets-header",{"is-fixed-toolbar-active":s}),children:(0,B.jsxs)(xr.NavigableToolbar,{className:"customize-widgets-header-toolbar","aria-label":(0,O.__)("Document tools"),children:[(0,B.jsx)(zt.ToolbarButton,{icon:(0,O.isRTL)()?kt:xt,label:(0,O.__)("Undo"),shortcut:$.displayShortcut.primary("z"),disabled:!i,onClick:t.undo,className:"customize-widgets-editor-history-button undo-button"}),(0,B.jsx)(zt.ToolbarButton,{icon:(0,O.isRTL)()?xt:kt,label:(0,O.__)("Redo"),shortcut:u,disabled:!d,onClick:t.redo,className:"customize-widgets-editor-history-button redo-button"}),(0,B.jsx)(zt.ToolbarButton,{className:"customize-widgets-header-toolbar__inserter-toggle",isPressed:r,variant:"primary",icon:ie,label:(0,O._x)("Add block","Generic label for block inserter button"),onClick:()=>{o(n=>!n)}}),(0,B.jsx)(_r,{})]})}),(0,X.createPortal)((0,B.jsx)(lr,{setIsOpened:o}),e.contentContainer[0])]})}var Cr=ea;var At=a(w()),Y=a(b());function Ir(t){let e=(0,Y.useSelect)(o=>o(x).isInserterOpened(),[]),{setIsInserterOpened:r}=(0,Y.useDispatch)(x);return(0,At.useEffect)(()=>{e?t.open():t.close()},[t,e]),[e,(0,At.useCallback)(o=>{let s=o;typeof o=="function"&&(s=o((0,Y.select)(x).isInserterOpened())),r(s)},[r])]}var Vr=a(z());var Tr=a(Wr()),J=a(w()),Tt=a(zr()),Z=a(G());var j=a(Yt()),Ar=a(G());function it(t){let e=t.match(/^widget_(.+)(?:\[(\d+)\])$/);if(e){let r=e[1],o=parseInt(e[2],10);return`${r}-${o}`}return t}function dt(t,e=null){let r;if(t.name==="core/legacy-widget"&&(t.attributes.id||t.attributes.instance))if(t.attributes.id)r={id:t.attributes.id};else{let{encoded:l,hash:u,raw:n,...f}=t.attributes.instance;r={idBase:t.attributes.idBase,instance:{...e?.instance,is_widget_customizer_js_value:!0,encoded_serialized_instance:l,instance_hash_key:u,raw_instance:n,...f}}}else r={idBase:"block",widgetClass:"WP_Widget_Block",instance:{raw_instance:{content:(0,j.serialize)(t)}}};let{form:s,rendered:i,...d}=e||{};return{...d,...r}}function pe({id:t,idBase:e,number:r,instance:o}){let s,{encoded_serialized_instance:i,instance_hash_key:d,raw_instance:l,...u}=o;if(e==="block"){let n=(0,j.parse)(l.content??"",{__unstableSkipAutop:!0});s=n.length?n[0]:(0,j.createBlock)("core/paragraph",{})}else r?s=(0,j.createBlock)("core/legacy-widget",{idBase:e,instance:{encoded:i,hash:d,raw:l,...u}}):s=(0,j.createBlock)("core/legacy-widget",{id:t});return(0,Ar.addWidgetIdToBlock)(s,t)}function ra(t){return t.map(e=>pe(e))}function Lr(t){let[e,r]=(0,J.useState)(()=>ra(t.getWidgets()));(0,J.useEffect)(()=>t.subscribe((s,i)=>{r(d=>{let l=new Map(s.map(f=>[f.id,f])),u=new Map(d.map(f=>[(0,Z.getWidgetIdFromBlock)(f),f])),n=i.map(f=>{let h=l.get(f.id);return h&&h===f?u.get(f.id):pe(f)});return(0,Tt.default)(d,n)?d:n})}),[t]);let o=(0,J.useCallback)(s=>{r(i=>{if((0,Tt.default)(i,s))return i;let d=new Map(i.map(n=>[(0,Z.getWidgetIdFromBlock)(n),n])),l=s.map(n=>{let f=(0,Z.getWidgetIdFromBlock)(n);if(f&&d.has(f)){let h=d.get(f),m=t.getWidget(f);return(0,Tr.default)(n,h)&&m?m:dt(n,m)}return dt(n)});if((0,Tt.default)(t.getWidgets(),l))return i;let u=t.setWidgets(l);return s.reduce((n,f,h)=>{let m=u[h];return m!==null&&(n===s&&(n=s.slice()),n[h]=(0,Z.addWidgetIdToBlock)(f,m)),n},s)})},[t]);return[e,o,o]}var lt=a(w()),Nr=a(b()),Or=a(z()),Fr=a(G());var W=a(w());var Mr=a(c()),he=(0,W.createContext)();he.displayName="FocusControlContext";function Rr({api:t,sidebarControls:e,children:r}){let[o,s]=(0,W.useState)({current:null}),i=(0,W.useCallback)(l=>{for(let u of e)if(u.setting.get().includes(l)){u.sectionInstance.expand({completeCallback(){s({current:l})}});break}},[e]);(0,W.useEffect)(()=>{function l(f){let h=it(f);i(h)}let u=!1;function n(){t.previewer.preview.bind("focus-control-for-setting",l),u=!0}return t.previewer.bind("ready",n),()=>{t.previewer.unbind("ready",n),u&&t.previewer.preview.unbind("focus-control-for-setting",l)}},[t,i]);let d=(0,W.useMemo)(()=>[o,i],[o,i]);return(0,Mr.jsx)(he.Provider,{value:d,children:r})}var Lt=()=>(0,W.useContext)(he);function Dr(t){let{selectBlock:e}=(0,Nr.useDispatch)(Or.store),[r]=Lt(),o=(0,lt.useRef)(t);(0,lt.useEffect)(()=>{o.current=t},[t]),(0,lt.useEffect)(()=>{if(r.current){let s=o.current.find(i=>(0,Fr.getWidgetIdFromBlock)(i)===r.current);s&&(e(s.clientId),document.querySelector(`[data-block="${s.clientId}"]`)?.focus())}},[r,e])}var Hr=a(jr()),{lock:Rs,unlock:nt}=(0,Hr.__dangerousOptInToUnstableAPIsOnlyForCoreModules)("I acknowledge private features are not for use in themes or plugins and doing so will break in the next version of WordPress.","@wordpress/customize-widgets");var Ur=a(c()),{ExperimentalBlockEditorProvider:oa}=nt(Vr.privateApis);function Gr({sidebar:t,settings:e,children:r}){let[o,s,i]=Lr(t);return Dr(o),(0,Ur.jsx)(oa,{value:o,onInput:s,onChange:i,settings:e,useSubRegistry:!1,children:r})}var T=a(E()),ft=a(R()),Kr=a(b()),qr=a(rt()),S=a(c());function $r({sidebar:t}){let{toggle:e}=(0,Kr.useDispatch)(qr.store),r=t.getWidgets().every(o=>o.id.startsWith("block-"));return(0,S.jsxs)("div",{className:"customize-widgets-welcome-guide",children:[(0,S.jsx)("div",{className:"customize-widgets-welcome-guide__image__wrapper",children:(0,S.jsxs)("picture",{children:[(0,S.jsx)("source",{srcSet:"https://s.w.org/images/block-editor/welcome-editor.svg",media:"(prefers-reduced-motion: reduce)"}),(0,S.jsx)("img",{className:"customize-widgets-welcome-guide__image",src:"https://s.w.org/images/block-editor/welcome-editor.gif",width:"312",height:"240",alt:""})]})}),(0,S.jsx)("h1",{className:"customize-widgets-welcome-guide__heading",children:(0,T.__)("Welcome to block Widgets")}),(0,S.jsx)("p",{className:"customize-widgets-welcome-guide__text",children:r?(0,T.__)("Your theme provides different \u201Cblock\u201D areas for you to add and edit content.\xA0Try adding a search bar, social icons, or other types of blocks here and see how they\u2019ll look on your site."):(0,T.__)("You can now add any block to your site\u2019s widget areas. Don\u2019t worry, all of your favorite widgets still work flawlessly.")}),(0,S.jsx)(ft.Button,{size:"compact",variant:"primary",onClick:()=>e("core/customize-widgets","welcomeGuide"),children:(0,T.__)("Got it")}),(0,S.jsx)("hr",{className:"customize-widgets-welcome-guide__separator"}),!r&&(0,S.jsxs)("p",{className:"customize-widgets-welcome-guide__more-info",children:[(0,T.__)("Want to stick with the old widgets?"),(0,S.jsx)("br",{}),(0,S.jsx)(ft.ExternalLink,{href:(0,T.__)("https://wordpress.org/plugins/classic-widgets/"),children:(0,T.__)("Get the Classic Widgets plugin.")})]}),(0,S.jsxs)("p",{className:"customize-widgets-welcome-guide__more-info",children:[(0,T.__)("New to the block editor?"),(0,S.jsx)("br",{}),(0,S.jsx)(ft.ExternalLink,{href:(0,T.__)("https://wordpress.org/documentation/article/wordpress-block-editor/"),children:(0,T.__)("Here's a detailed guide.")})]})]})}var Xr=a(w()),Q=a(at()),Yr=a(q()),Zr=a(b()),Mt=a(E());function Jr({undo:t,redo:e,save:r}){return(0,Q.useShortcut)("core/customize-widgets/undo",o=>{t(),o.preventDefault()}),(0,Q.useShortcut)("core/customize-widgets/redo",o=>{e(),o.preventDefault()}),(0,Q.useShortcut)("core/customize-widgets/save",o=>{o.preventDefault(),r()}),null}function aa(){let{registerShortcut:t,unregisterShortcut:e}=(0,Zr.useDispatch)(Q.store);return(0,Xr.useEffect)(()=>(t({name:"core/customize-widgets/undo",category:"global",description:(0,Mt.__)("Undo your last changes."),keyCombination:{modifier:"primary",character:"z"}}),t({name:"core/customize-widgets/redo",category:"global",description:(0,Mt.__)("Redo your last undo."),keyCombination:{modifier:"primaryShift",character:"z"},aliases:(0,Yr.isAppleOS)()?[]:[{modifier:"primary",character:"y"}]}),t({name:"core/customize-widgets/save",category:"global",description:(0,Mt.__)("Save your changes."),keyCombination:{modifier:"primary",character:"s"}}),()=>{e("core/customize-widgets/undo"),e("core/customize-widgets/redo"),e("core/customize-widgets/save")}),[t]),null}Jr.Register=aa;var ge=Jr;var Rt=a(w()),Nt=a(z()),Qr=a(b()),to=a(c());function eo(t){let e=(0,Rt.useRef)(),r=(0,Qr.useSelect)(o=>o(Nt.store).getBlockCount()===0);return(0,Rt.useEffect)(()=>{if(r&&e.current){let{ownerDocument:o}=e.current;(!o.activeElement||o.activeElement===o.body)&&e.current.focus()}},[r]),(0,to.jsx)(Nt.ButtonBlockAppender,{...t,ref:e})}var v=a(c()),{ExperimentalBlockCanvas:sa}=nt(L.privateApis),{BlockKeyboardShortcuts:ia}=nt(lo.privateApis);function no({blockEditorSettings:t,sidebar:e,inserter:r,inspector:o}){let[s,i]=Ir(r),d=(0,ro.useViewportMatch)("small"),{hasUploadPermissions:l,isFixedToolbarActive:u,keepCaretInsideBlock:n,isWelcomeGuideActive:f}=(0,ao.useSelect)(m=>{let{get:_}=m(io.store);return{hasUploadPermissions:m(oo.store).canUser("create",{kind:"postType",name:"attachment"})??!0,isFixedToolbarActive:!!_("core/customize-widgets","fixedToolbar"),keepCaretInsideBlock:!!_("core/customize-widgets","keepCaretInsideBlock"),isWelcomeGuideActive:!!_("core/customize-widgets","welcomeGuide")}},[]),h=(0,Ot.useMemo)(()=>{let m;return l&&(m=({onError:_,...ct})=>{(0,so.uploadMedia)({wpAllowedMimeTypes:t.allowedMimeTypes,onError:({message:M})=>_(M),...ct})}),{...t,__experimentalSetIsInserterOpened:i,mediaUpload:m,hasFixedToolbar:u||!d,keepCaretInsideBlock:n,editorTool:"edit",__unstableHasCustomAppender:!0}},[l,t,u,d,n,i]);return f?(0,v.jsx)($r,{sidebar:e}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ge.Register,{}),(0,v.jsx)(ia,{}),(0,v.jsxs)(Gr,{sidebar:e,settings:h,children:[(0,v.jsx)(ge,{undo:e.undo,redo:e.redo,save:e.save}),(0,v.jsx)(Cr,{sidebar:e,inserter:r,isInserterOpened:s,setIsInserterOpened:i,isFixedToolbarActive:u||!d}),(u||!d)&&(0,v.jsx)(L.BlockToolbar,{hideDragHandle:!0}),(0,v.jsx)(sa,{shouldIframe:!1,styles:h.defaultEditorStyles,height:"100%",children:(0,v.jsx)(L.BlockList,{renderAppender:eo})}),(0,Ot.createPortal)((0,v.jsx)("form",{onSubmit:m=>m.preventDefault(),children:(0,v.jsx)(L.BlockInspector,{})}),o.contentContainer[0])]}),(0,v.jsx)(L.__unstableBlockSettingsMenuFirstItem,{children:({onClose:m})=>(0,v.jsx)(Ye,{inspector:o,closeMenu:m})})]})}var U=a(w()),fo=a(c()),Ft=(0,U.createContext)();Ft.displayName="SidebarControlsContext";function uo({sidebarControls:t,activeSidebarControl:e,children:r}){let o=(0,U.useMemo)(()=>({sidebarControls:t,activeSidebarControl:e}),[t,e]);return(0,fo.jsx)(Ft.Provider,{value:o,children:r})}function mo(){let{sidebarControls:t}=(0,U.useContext)(Ft);return t}function co(){let{activeSidebarControl:t}=(0,U.useContext)(Ft);return t}var po=a(w()),Dt=a(b()),we=a(z());function ho(t,e){let{hasSelectedBlock:r,hasMultiSelection:o}=(0,Dt.useSelect)(we.store),{clearSelectedBlock:s}=(0,Dt.useDispatch)(we.store);(0,po.useEffect)(()=>{if(e.current&&t){let i=function(m){(r()||o())&&m&&f.contains(m)&&!n.contains(m)&&!e.current.contains(m)&&!m.closest('[role="dialog"]')&&!u.expanded()&&s()},d=function(m){i(m.target)},l=function(){i(f.activeElement)},u=t.inspector,n=t.container[0],f=n.ownerDocument,h=f.defaultView;return f.addEventListener("mousedown",d),h.addEventListener("blur",l),()=>{f.removeEventListener("mousedown",d),h.removeEventListener("blur",l)}}},[e,t,r,o,s])}var F=a(c());function go({api:t,sidebarControls:e,blockEditorSettings:r}){let[o,s]=(0,D.useState)(null),i=document.getElementById("customize-theme-controls"),d=(0,D.useRef)();ho(o,d),(0,D.useEffect)(()=>{let n=e.map(f=>f.subscribe(h=>{h&&s(f)}));return()=>{n.forEach(f=>f())}},[e]);let l=o&&(0,D.createPortal)((0,F.jsx)(Pe,{children:(0,F.jsx)(no,{blockEditorSettings:r,sidebar:o.sidebarAdapter,inserter:o.inserter,inspector:o.inspector},o.id)}),o.container[0]),u=i&&(0,D.createPortal)((0,F.jsx)("div",{className:"customize-widgets-popover",ref:d,children:(0,F.jsx)(Pt.Popover.Slot,{})}),i);return(0,F.jsx)(Pt.SlotFillProvider,{children:(0,F.jsx)(uo,{sidebarControls:e,activeSidebarControl:o,children:(0,F.jsxs)(Rr,{api:t,sidebarControls:e,children:[l,u]})})})}var jt=a(E());function wo(){let{wp:{customize:t}}=window;return class extends t.Section{constructor(r,o){super(r,o),this.parentSection=o.parentSection,this.returnFocusWhenClose=null,this._isOpen=!1}get isOpen(){return this._isOpen}set isOpen(r){this._isOpen=r,this.triggerActiveCallbacks()}ready(){this.contentContainer[0].classList.add("customize-widgets-layout__inspector")}isContextuallyActive(){return this.isOpen}onChangeExpanded(r,o){super.onChangeExpanded(r,o),this.parentSection&&!o.unchanged&&(r?this.parentSection.collapse({manualTransition:!0}):this.parentSection.expand({manualTransition:!0,completeCallback:()=>{this.returnFocusWhenClose&&!this.contentContainer[0].contains(this.returnFocusWhenClose)&&this.returnFocusWhenClose.focus()}}))}open({returnFocusWhenClose:r}={}){this.isOpen=!0,this.returnFocusWhenClose=r,this.expand({allowMultiple:!0})}close(){this.collapse({allowMultiple:!0})}collapse(r){this.isOpen=!1,super.collapse(r)}triggerActiveCallbacks(){this.active.callbacks.fireWith(this.active,[!1,!0])}}}var da=t=>`widgets-inspector-${t}`;function bo(){let{wp:{customize:t}}=window,e=window.matchMedia("(prefers-reduced-motion: reduce)"),r=e.matches;return e.addEventListener("change",o=>{r=o.matches}),class extends t.Section{ready(){let s=wo();this.inspector=new s(da(this.id),{title:(0,jt.__)("Block Settings"),parentSection:this,customizeAction:[(0,jt.__)("Customizing"),(0,jt.__)("Widgets"),this.params.title].join(" \u25B8 ")}),t.section.add(this.inspector),this.contentContainer[0].classList.add("customize-widgets__sidebar-section")}hasSubSectionOpened(){return this.inspector.expanded()}onChangeExpanded(s,i){let d=this.controls(),l={...i,completeCallback(){d.forEach(u=>{u.onChangeSectionExpanded?.(s,l)}),i.completeCallback?.()}};if(l.manualTransition){s?(this.contentContainer.addClass(["busy","open"]),this.contentContainer.removeClass("is-sub-section-open"),this.contentContainer.closest(".wp-full-overlay").addClass("section-open")):(this.contentContainer.addClass(["busy","is-sub-section-open"]),this.contentContainer.closest(".wp-full-overlay").addClass("section-open"),this.contentContainer.removeClass("open"));let u=()=>{this.contentContainer.removeClass("busy"),l.completeCallback()};r?u():this.contentContainer.one("transitionend",u)}else super.onChangeExpanded(s,l)}}}var Bo=a(b());var{wp:yo}=window;function vo(t){let e=t.match(/^(.+)-(\d+)$/);return e?{idBase:e[1],number:parseInt(e[2],10)}:{idBase:t}}function be(t){let{idBase:e,number:r}=vo(t);return r?`widget_${e}[${r}]`:`widget_${e}`}function la(t,e,r){let o=!1,s;function i(...d){let l=(o?e:t).apply(this,d);return o=!0,clearTimeout(s),s=setTimeout(()=>{o=!1},r),l}return i.cancel=()=>{o=!1,clearTimeout(s)},i}var So=class{constructor(t,e){this.setting=t,this.api=e,this.locked=!1,this.widgetsCache=new WeakMap,this.subscribers=new Set,this.history=[this._getWidgetIds().map(r=>this.getWidget(r))],this.historyIndex=0,this.historySubscribers=new Set,this._debounceSetHistory=la(this._pushHistory,this._replaceHistory,1e3),this.setting.bind(this._handleSettingChange.bind(this)),this.api.bind("change",this._handleAllSettingsChange.bind(this)),this.undo=this.undo.bind(this),this.redo=this.redo.bind(this),this.save=this.save.bind(this)}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}getWidgets(){return this.history[this.historyIndex]}_emit(...t){for(let e of this.subscribers)e(...t)}_getWidgetIds(){return this.setting.get()}_pushHistory(){this.history=[...this.history.slice(0,this.historyIndex+1),this._getWidgetIds().map(t=>this.getWidget(t))],this.historyIndex+=1,this.historySubscribers.forEach(t=>t())}_replaceHistory(){this.history[this.historyIndex]=this._getWidgetIds().map(t=>this.getWidget(t))}_handleSettingChange(){if(this.locked)return;let t=this.getWidgets();this._pushHistory(),this._emit(t,this.getWidgets())}_handleAllSettingsChange(t){if(this.locked||!t.id.startsWith("widget_"))return;let e=it(t.id);if(!this.setting.get().includes(e))return;let r=this.getWidgets();this._pushHistory(),this._emit(r,this.getWidgets())}_createWidget(t){let e=yo.customize.Widgets.availableWidgets.findWhere({id_base:t.idBase}),r=t.number;e.get("is_multi")&&!r&&(e.set("multi_number",e.get("multi_number")+1),r=e.get("multi_number"));let o=r?`widget_${t.idBase}[${r}]`:`widget_${t.idBase}`,s={transport:yo.customize.Widgets.data.selectiveRefreshableWidgets[e.get("id_base")]?"postMessage":"refresh",previewer:this.setting.previewer};return this.api.create(o,o,"",s).set(t.instance),it(o)}_removeWidget(t){let e=be(t.id),r=this.api(e);if(r){let o=r.get();this.widgetsCache.delete(o)}this.api.remove(e)}_updateWidget(t){let e=this.getWidget(t.id);if(e===t)return t.id;if(e.idBase&&t.idBase&&e.idBase===t.idBase){let r=be(t.id);return this.api(r).set(t.instance),t.id}return this._removeWidget(t),this._createWidget(t)}getWidget(t){if(!t)return null;let{idBase:e,number:r}=vo(t),o=be(t),s=this.api(o);if(!s)return null;let i=s.get();if(this.widgetsCache.has(i))return this.widgetsCache.get(i);let d={id:t,idBase:e,number:r,instance:i};return this.widgetsCache.set(i,d),d}_updateWidgets(t){this.locked=!0;let e=[],r=t.map(s=>{if(s.id&&this.getWidget(s.id))return e.push(null),this._updateWidget(s);let i=this._createWidget(s);return e.push(i),i});return this.getWidgets().filter(s=>!r.includes(s.id)).forEach(s=>this._removeWidget(s)),this.setting.set(r),this.locked=!1,e}setWidgets(t){let e=this._updateWidgets(t);return this._debounceSetHistory(),e}hasUndo(){return this.historyIndex>0}hasRedo(){return this.historyIndex<this.history.length-1}_seek(t){let e=this.getWidgets();this.historyIndex=t;let r=this.history[this.historyIndex];this._updateWidgets(r),this._emit(e,this.getWidgets()),this.historySubscribers.forEach(o=>o()),this._debounceSetHistory.cancel()}undo(){this.hasUndo()&&this._seek(this.historyIndex-1)}redo(){this.hasRedo()&&this._seek(this.historyIndex+1)}subscribeHistory(t){return this.historySubscribers.add(t),()=>{this.historySubscribers.delete(t)}}save(){this.api.previewer.save()}};var xo=a(q()),Co=a(_o()),ye=a(b());function Io(){let{wp:{customize:t}}=window,e=t.OuterSection;return t.OuterSection=class extends e{onChangeExpanded(r,o){return r&&t.section.each(s=>{s.params.type==="outer"&&s.id!==this.id&&s.expanded()&&s.collapse()}),super.onChangeExpanded(r,o)}},t.sectionConstructor.outer=t.OuterSection,class extends t.OuterSection{constructor(...o){super(...o),this.params.type="outer",this.activeElementBeforeExpanded=null,this.contentContainer[0].ownerDocument.defaultView.addEventListener("keydown",i=>{this.expanded()&&(i.keyCode===xo.ESCAPE||i.code==="Escape")&&!i.defaultPrevented&&(i.preventDefault(),i.stopPropagation(),(0,ye.dispatch)(x).setIsInserterOpened(!1))},!0),this.contentContainer.addClass("widgets-inserter"),this.isFromInternalAction=!1,this.expanded.bind(()=>{this.isFromInternalAction||(0,ye.dispatch)(x).setIsInserterOpened(this.expanded()),this.isFromInternalAction=!1})}open(){if(!this.expanded()){let o=this.contentContainer[0];this.activeElementBeforeExpanded=o.ownerDocument.activeElement,this.isFromInternalAction=!0,this.expand({completeCallback(){let s=Co.focus.tabbable.find(o)[1];s&&s.focus()}})}}close(){if(this.expanded()){let o=this.contentContainer[0],s=o.ownerDocument.activeElement;this.isFromInternalAction=!0,this.collapse({completeCallback(){o.contains(s)&&this.activeElementBeforeExpanded&&this.activeElementBeforeExpanded.focus()}})}}}}var na=t=>`widgets-inserter-${t}`;function Wo(){let{wp:{customize:t}}=window;return class extends t.Control{constructor(...r){super(...r),this.subscribers=new Set}ready(){let r=Io();this.inserter=new r(na(this.id),{}),t.section.add(this.inserter),this.sectionInstance=t.section(this.section()),this.inspector=this.sectionInstance.inspector,this.sidebarAdapter=new So(this.setting,t)}subscribe(r){return this.subscribers.add(r),()=>{this.subscribers.delete(r)}}onChangeSectionExpanded(r,o){o.unchanged||(r||(0,Bo.dispatch)(x).setIsInserterOpened(!1),this.subscribers.forEach(s=>s(r,o)))}}}var tt=a(z()),Eo=a(K()),ut=a(b()),zo=a(ot()),Ht=a(G());var H=a(c()),fa=(0,Eo.createHigherOrderComponent)(t=>e=>{let r=(0,Ht.getWidgetIdFromBlock)(e),o=mo(),s=co(),i=o?.length>1,d=e.name,l=e.clientId,u=(0,ut.useSelect)(_=>_(tt.store).canInsertBlockType(d,""),[d]),n=(0,ut.useSelect)(_=>_(tt.store).getBlock(l),[l]),{removeBlock:f}=(0,ut.useDispatch)(tt.store),[,h]=Lt();function m(_){let ct=o.find(M=>M.id===_);if(r){let M=s.setting,Kt=ct.setting;M(M().filter(qt=>qt!==r)),Kt([...Kt(),r])}else{let M=ct.sidebarAdapter;f(l),r=M.setWidgets([...M.getWidgets(),dt(n)]).reverse().find(qt=>!!qt)}h(r)}return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(t,{...e},"edit"),i&&u&&(0,H.jsx)(tt.BlockControls,{children:(0,H.jsx)(Ht.MoveToWidgetArea,{widgetAreas:o.map(_=>({id:_.id,name:_.params.label,description:_.params.description})),currentWidgetAreaId:s?.id,onSelect:m})})]})},"withMoveToSidebarToolbarItem");(0,zo.addFilter)("editor.BlockEdit","core/customize-widgets/block-edit",fa);var Ao=a(ot()),To=a(Jt()),ua=()=>To.MediaUpload;(0,Ao.addFilter)("editor.MediaUpload","core/edit-widgets/replace-media-upload",ua);var Lo=a(K()),Mo=a(ot()),Ro=a(c()),{wp:ma}=window,ca=(0,Lo.createHigherOrderComponent)(t=>e=>{let{idBase:r}=e.attributes,o=ma.customize.Widgets.data.availableWidgets.find(s=>s.id_base===r)?.is_wide??!1;return(0,Ro.jsx)(t,{...e,isWide:o},"edit")},"withWideWidgetDisplay");(0,Mo.addFilter)("editor.BlockEdit","core/customize-widgets/wide-widget-display",ca);var Se=a(c()),{wp:mt}=window,pa=["core/more","core/block","core/freeform","core/template-part"];function ha(t,e){(0,ve.dispatch)(No.store).setDefaults("core/customize-widgets",{fixedToolbar:!1,welcomeGuide:!0}),(0,ve.dispatch)(Gt.store).reapplyBlockTypeFilters();let r=(0,Ut.__experimentalGetCoreBlocks)().filter(i=>!(pa.includes(i.name)||i.name.startsWith("core/post")||i.name.startsWith("core/query")||i.name.startsWith("core/site")||i.name.startsWith("core/navigation")||i.name.startsWith("core/term")));(0,Ut.registerCoreBlocks)(r),(0,et.registerLegacyWidgetBlock)(),(0,et.registerLegacyWidgetVariations)(e),(0,et.registerWidgetGroupBlock)(),(0,Gt.setFreeformContentHandlerName)("core/html");let o=Wo(e);mt.customize.sectionConstructor.sidebar=bo(),mt.customize.controlConstructor.sidebar_block_editor=o;let s=document.createElement("div");document.body.appendChild(s),mt.customize.bind("ready",()=>{let i=[];mt.customize.control.each(d=>{d instanceof o&&i.push(d)}),(0,Vt.createRoot)(s).render((0,Se.jsx)(Vt.StrictMode,{children:(0,Se.jsx)(go,{api:mt.customize,sidebarControls:i,blockEditorSettings:e})}))})}return Ho(ga);})();