import{store as P,getContext as u,getElement as v,getConfig as A,withSyncEvent as T,withScope as C}from"@wordpress/interactivity";var L=200;var w=!1,W=0,x={startX:0,startY:0,startTime:0},Y=[".wp-lightbox-close-button",".wp-lightbox-navigation-button"];function O({uploadedSrc:t}){return t||"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="}function R({lightboxSrcset:t}){return t||""}var{state:e,actions:y,callbacks:S}=P("core/image",{state:{selectedImageId:null,selectedGalleryId:null,preloadTimers:new Map,preloadedImageIds:new Set,get galleryImages(){return e.selectedGalleryId?Object.entries(e.metadata).filter(([,t])=>t.galleryId===e.selectedGalleryId).sort(([,t],[,a])=>{let o=t.order??0,l=a.order??0;return o-l}).map(([t])=>t):[e.selectedImageId]},get selectedImageIndex(){return e.galleryImages.findIndex(t=>t===e.selectedImageId)},get selectedImage(){return e.metadata[e.selectedImageId]},get hasNavigationIcon(){let{navigationButtonType:t}=e.selectedImage;return t==="icon"||t==="both"},get hasNavigationText(){let{navigationButtonType:t}=e.selectedImage;return t==="text"||t==="both"},get thisImage(){let{imageId:t}=u();return e.metadata[t]},get hasNavigation(){return e.galleryImages.length>1},get hasNextImage(){return e.selectedImageIndex+1<e.galleryImages.length},get hasPreviousImage(){return e.selectedImageIndex-1>=0},get overlayOpened(){return e.selectedImageId!==null},get roleAttribute(){return e.overlayOpened?"dialog":null},get ariaModal(){return e.overlayOpened?"true":null},get ariaLabel(){return e.selectedImage.customAriaLabel||A().defaultAriaLabel},get closeButtonAriaLabel(){return e.hasNavigationText?void 0:A().closeButtonText},get prevButtonAriaLabel(){return e.hasNavigationText?void 0:A().prevButtonText},get nextButtonAriaLabel(){return e.hasNavigationText?void 0:A().nextButtonText},get enlargedSrc(){return O(e.selectedImage)},get enlargedSrcset(){return R(e.selectedImage)},get figureStyles(){return e.overlayOpened&&`${e.selectedImage.figureStyles?.replace(/margin[^;]*;?/g,"")};`},get imgStyles(){return e.overlayOpened&&`${e.selectedImage.imgStyles?.replace(/;$/,"")}; object-fit:cover;`},get isContentHidden(){let t=u();return e.overlayEnabled&&e.selectedImageId===t.imageId},get isContentVisible(){let t=u();return!e.overlayEnabled&&e.selectedImageId===t.imageId}},actions:{showLightbox(){let{imageId:t}=u();if(!e.metadata[t].imageRef?.complete)return;e.scrollTopReset=document.documentElement.scrollTop,e.scrollLeftReset=document.documentElement.scrollLeft,e.selectedImageId=t;let{galleryId:a}=u("core/gallery")||{};e.selectedGalleryId=a||null,e.overlayEnabled=!0,S.setOverlayStyles()},hideLightbox(){e.overlayEnabled&&(e.overlayEnabled=!1,setTimeout(function(){e.selectedImage.buttonRef.focus({preventScroll:!0}),e.selectedImageId=null,e.selectedGalleryId=null},450))},showPreviousImage:T(t=>{t.stopPropagation();let a=e.hasPreviousImage?e.selectedImageIndex-1:e.galleryImages.length-1;e.selectedImageId=e.galleryImages[a],S.setOverlayStyles()}),showNextImage:T(t=>{t.stopPropagation();let a=e.hasNextImage?e.selectedImageIndex+1:0;e.selectedImageId=e.galleryImages[a],S.setOverlayStyles()}),handleKeydown:T(t=>{if(e.overlayEnabled){if(t.key==="Escape")y.hideLightbox();else if(t.key==="ArrowLeft")y.showPreviousImage(t);else if(t.key==="ArrowRight")y.showNextImage(t);else if(t.key==="Tab"){let a=Array.from(document.querySelectorAll(Y)),o=a[0],l=a[a.length-1];t.shiftKey&&t.target===o?(t.preventDefault(),l.focus()):!t.shiftKey&&t.target===l&&(t.preventDefault(),o.focus())}}}),handleTouchMove:T(t=>{e.overlayEnabled&&t.preventDefault()}),handleTouchStart(t){w=!0;let a=t.touches&&t.touches[0];a&&(x.startX=a.clientX,x.startY=a.clientY,x.startTime=Date.now())},handleTouchEnd:T(t=>{let a=t.changedTouches&&t.changedTouches[0]||t.touches&&t.touches[0],o=Date.now();if(a&&e.overlayEnabled){let l=a.clientX-x.startX,h=a.clientY-x.startY,m=Math.abs(l),s=Math.abs(h),d=o-x.startTime;m>50&&m>s*1.5&&d<800&&(t.preventDefault(),l<0?y.showNextImage(t):y.showPreviousImage(t))}W=o,w=!1}),handleScroll(){e.overlayOpened&&!w&&Date.now()-W>450&&window.scrollTo(e.scrollLeftReset,e.scrollTopReset)},preloadImage(){let{imageId:t}=u();if(e.preloadedImageIds.has(t))return;let a=e.metadata[t],o=document.createElement("link");o.rel="preload",o.as="image",o.href=O(a);let l=R(a);l&&(o.setAttribute("imagesrcset",l),o.setAttribute("imagesizes","100vw")),document.head.appendChild(o),e.preloadedImageIds.add(t)},preloadImageWithDelay(){let{imageId:t}=u();y.cancelPreload();let a=setTimeout(C(()=>{y.preloadImage(),e.preloadTimers.delete(t)}),L);e.preloadTimers.set(t,a)},cancelPreload(){let{imageId:t}=u();e.preloadTimers.has(t)&&(clearTimeout(e.preloadTimers.get(t)),e.preloadTimers.delete(t))}},callbacks:{setOverlayStyles(){if(!e.overlayEnabled)return;let{naturalWidth:t,naturalHeight:a,offsetWidth:o,offsetHeight:l}=e.selectedImage.imageRef,{x:h,y:m}=e.selectedImage.imageRef.getBoundingClientRect(),s=t/a,d=o/l;if(e.selectedImage.scaleAttr==="contain")if(s>d){let g=o/s;m+=(l-g)/2,l=g}else{let g=l*s;h+=(o-g)/2,o=g}d=o/l;let r=parseFloat(e.selectedImage.targetWidth&&e.selectedImage.targetWidth!=="none"?e.selectedImage.targetWidth:t),i=parseFloat(e.selectedImage.targetHeight&&e.selectedImage.targetHeight!=="none"?e.selectedImage.targetHeight:a),I=r/i,f=r,p=i,c=r,n=i;if(s.toFixed(2)!==I.toFixed(2)){if(s>I){let g=r/s;i-g>r?(i=g,r=g*s):i=r/s}else{let g=i*s;r-g>i?(r=g,i=g/s):r=i*s}c=r,n=i,I=r/i,d>I?(f=r,p=f/d):(p=i,f=p*d)}(o>c||l>n)&&(c=o,n=l);let E=0,b=160;480<window.innerWidth&&(E=80,b=160),960<window.innerWidth&&(E=e.hasNavigation?320:80,b=80);let D=Math.min(window.innerWidth-E,c),N=Math.min(window.innerHeight-b,n),_=D/N;d>_?(c=D,n=c/d):(n=N,c=n*d);let M=o/c,H=r*(c/f),B=i*(n/p);e.overlayStyles=`
					--wp--lightbox-initial-top-position: ${m}px;
					--wp--lightbox-initial-left-position: ${h}px;
					--wp--lightbox-container-width: ${c+1}px;
					--wp--lightbox-container-height: ${n+1}px;
					--wp--lightbox-image-width: ${H}px;
					--wp--lightbox-image-height: ${B}px;
					--wp--lightbox-scale: ${M};
					--wp--lightbox-scrollbar-width: ${window.innerWidth-document.documentElement.clientWidth}px;
				`},setButtonStyles(){let{ref:t}=v();if(!t)return;let{imageId:a}=u();e.metadata[a].imageRef=t,e.metadata[a].currentSrc=t.currentSrc;let{naturalWidth:o,naturalHeight:l,offsetWidth:h,offsetHeight:m}=t;if(o===0||l===0)return;let s=t.parentElement,d=t.parentElement.clientWidth,r=t.parentElement.clientHeight,i=s.querySelector("figcaption");if(i){let n=window.getComputedStyle(i);["absolute","fixed"].includes(n.position)||(r=r-i.offsetHeight-parseFloat(n.marginTop)-parseFloat(n.marginBottom))}let I=r-m,f=d-h,p=I+16,c=f+16;if(e.metadata[a].scaleAttr==="contain"){let n=o/l,E=h/m;if(n>=E){let b=h/n;p=(m-b)/2+I+16,c=f+16}else{let b=m*n;p=I+16,c=(h-b)/2+f+16}}e.metadata[a].buttonTop=p,e.metadata[a].buttonRight=c},setOverlayFocus(){if(e.overlayEnabled){let{ref:t}=v();t.focus()}},setInertElements(){document.querySelectorAll("body > :not(.wp-lightbox-overlay)").forEach(t=>{e.overlayEnabled?t.setAttribute("inert",""):t.removeAttribute("inert")})},initTriggerButton(){let{imageId:t}=u(),{ref:a}=v();e.metadata[t].buttonRef=a}}},{lock:!0});