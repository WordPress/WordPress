var U=Object.create;var T=Object.defineProperty;var K=Object.getOwnPropertyDescriptor;var z=Object.getOwnPropertyNames;var O=Object.getPrototypeOf,B=Object.prototype.hasOwnProperty;var c=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var M=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of z(t))!B.call(e,s)&&s!==r&&T(e,s,{get:()=>t[s],enumerable:!(i=K(t,s))||i.enumerable});return e};var f=(e,t,r)=>(r=e!=null?U(O(e)):{},M(t||!e||!e.__esModule?T(r,"default",{value:e,enumerable:!0}):r,e));var p=c((Y,V)=>{V.exports=window.wp.data});var m=c((G,x)=>{x.exports=window.wp.coreData});var S=c((J,P)=>{P.exports=window.wp.element});var g=c((X,A)=>{A.exports=window.wp.preferences});var u=f(p()),d=f(m());import{notFound as E}from"@wordpress/route";var _=f(S(),1),b=f(p(),1),N=f(g(),1);function y(e,t,r){return`dataviews-${e}-${t}-${r}`}function h(e,t,r){if(!t)return e;let i=e;if(t.filters&&t.filters.length>0){let s=new Set(t.filters.map(n=>n.field)),o=(e.filters??[]).filter(n=>!s.has(n.field));i={...i,filters:[...o,...t.filters]}}return t.sort&&r&&e.sort?.field===r.sort?.field&&e.sort?.direction===r.sort?.direction&&(i={...i,sort:t.sort}),i}var v=f(p(),1),D=f(g(),1);async function w(e){let{kind:t,name:r,slug:i,defaultView:s,activeViewOverrides:o,queryParams:n}=e,l=y(t,r,i),$=(0,v.select)(D.store).get("core/views",l)??s,j=n?.page??1,q=n?.search??"";return h({...$,page:j,search:q},o,s)}var F=f(p()),L=f(m()),Q={type:"table",sort:{field:"date",direction:"desc"},fields:["author","status","date"],titleField:"title",mediaField:"featured_media",descriptionField:"excerpt"};function R(e){return e==="all"?{}:{filters:[{field:"status",operator:"is",value:e}]}}function C(e){return{...Q,showLevels:e?.hierarchical}}async function I(e,t,r){let i=await(0,F.resolveSelect)(L.store).getPostType(e),s=C(i);return w({kind:"postType",name:e,slug:"default-new",defaultView:s,activeViewOverrides:R(t??"all"),queryParams:r})}function k(e,t){let r={};if(e.perPage!==void 0&&(r.per_page=e.perPage),e.page!==void 0&&(r.page=e.page),[void 0,""].includes(e.search)||(r.search=e.search),e.sort?.field!==void 0){let a=e.sort.field;a==="attached_to"&&(a="parent"),r.orderby=a}e.sort?.direction!==void 0&&(r.order=e.sort.direction),e.showLevels&&(r.orderby_hierarchy=!0);let i=e.filters?.find(a=>a.field==="status");i?r.status=i.value:t==="attachment"?r.status="inherit":r.status="draft,future,pending,private,publish";let s=e.filters?.find(a=>a.field==="author");s&&s.operator==="is"?r.author=s.value:s&&s.operator==="isNot"&&(r.author_exclude=s.value);let o=e.filters?.find(a=>a.field==="comment_status");o&&o.operator==="is"?r.comment_status=o.value:o&&o.operator==="isNot"&&(r.comment_status_exclude=o.value);let n=e.filters?.find(a=>a.field==="media_type");n&&(r.media_type=n.value);let l=e.filters?.find(a=>a.field==="date");return l&&l.value&&(l.operator==="before"?r.before=l.value:l.operator==="after"&&(r.after=l.value)),t==="attachment"&&(r._embed="wp:attached-to"),r}var we={beforeLoad:async({params:e})=>{try{if(!await(0,u.resolveSelect)(d.store).getPostType(e.type))throw E()}catch{throw E()}},title:async({params:e})=>(await(0,u.resolveSelect)(d.store).getPostType(e.type))?.labels?.name||e.type,async canvas(e){let{params:t,search:r}=e,i=await I(t.type,t.slug,{page:r.page,search:r.search});if(i.type!=="list")return;if(r.postIds&&r.postIds.length>0){let n=r.postIds[0].toString();return{postType:t.type,postId:n,isPreview:!0,editLink:`/types/${t.type}/edit/${n}`}}let s=k(i,t.type),o=await(0,u.resolveSelect)(d.store).getEntityRecords("postType",t.type,{...s,per_page:1});if(o&&o.length>0){let n=o[0].id.toString();return{postType:t.type,postId:n,isPreview:!0,editLink:`/types/${t.type}/edit/${n}`}}}};export{we as route};
