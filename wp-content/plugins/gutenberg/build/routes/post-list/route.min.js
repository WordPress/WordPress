var U=Object.create;var w=Object.defineProperty;var k=Object.getOwnPropertyDescriptor;var K=Object.getOwnPropertyNames;var O=Object.getPrototypeOf,z=Object.prototype.hasOwnProperty;var f=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports);var C=(e,r,t,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of K(r))!z.call(e,s)&&s!==t&&w(e,s,{get:()=>r[s],enumerable:!(i=k(r,s))||i.enumerable});return e};var o=(e,r,t)=>(t=e!=null?U(O(e)):{},C(r||!e||!e.__esModule?w(t,"default",{value:e,enumerable:!0}):t,e));var l=f(($,h)=>{h.exports=window.wp.data});var c=f((B,y)=>{y.exports=window.wp.coreData});var V=f((G,v)=>{v.exports=window.wp.element});var g=f((H,x)=>{x.exports=window.wp.preferences});var L=o(l()),E=o(c());function d(e,r,t){return`dataviews-${e}-${r}-${t}`}var T=o(V()),P=o(l()),M=o(g());var _=o(l()),S=o(g());async function m(e){let{kind:r,name:t,slug:i,defaultView:s,queryParams:n}=e,p=d(r,t,i),F=(0,_.select)(S.store).get("core/views",p)??s,j=n?.page??1,q=n?.search??"";return{...F,page:j,search:q}}var b=o(l()),A=o(c()),u={type:"table",sort:{field:"date",direction:"desc"},fields:["author","status","date"],titleField:"title",mediaField:"featured_media",descriptionField:"excerpt"};var N=[{slug:"all",label:"All",view:{...u}},{slug:"publish",label:"Published",view:{...u,filters:[{field:"status",operator:"is",value:"publish"}]}},{slug:"draft",label:"Draft",view:{...u,filters:[{field:"status",operator:"is",value:"draft"}]}},{slug:"pending",label:"Pending",view:{...u,filters:[{field:"status",operator:"is",value:"pending"}]}},{slug:"private",label:"Private",view:{...u,filters:[{field:"status",operator:"is",value:"private"}]}},{slug:"trash",label:"Trash",view:{...u,filters:[{field:"status",operator:"is",value:"trash"}]}}];function Q(e,r){return{...N.find(s=>s.slug===r)?.view||u,showLevels:e?.hierarchical}}async function D(e,r,t){let i=await(0,b.resolveSelect)(A.store).getPostType(e),s=Q(i,r);return m({kind:"postType",name:e,slug:r??"all",defaultView:s,queryParams:t})}function I(e,r){let t={};if(e.perPage!==void 0&&(t.per_page=e.perPage),e.page!==void 0&&(t.page=e.page),[void 0,""].includes(e.search)||(t.search=e.search),e.sort?.field!==void 0){let a=e.sort.field;a==="attached_to"&&(a="parent"),t.orderby=a}e.sort?.direction!==void 0&&(t.order=e.sort.direction),e.showLevels&&(t.orderby_hierarchy=!0);let i=e.filters?.find(a=>a.field==="status");i?t.status=i.value:r==="attachment"?t.status="inherit":t.status="draft,future,pending,private,publish";let s=e.filters?.find(a=>a.field==="author");s&&s.operator==="is"?t.author=s.value:s&&s.operator==="isNot"&&(t.author_exclude=s.value);let n=e.filters?.find(a=>a.field==="comment_status");n&&n.operator==="is"?t.comment_status=n.value:n&&n.operator==="isNot"&&(t.comment_status_exclude=n.value);let p=e.filters?.find(a=>a.field==="media_type");return p&&(t.media_type=p.value),r==="attachment"&&(t._embed="wp:attached-to"),t}var pe={async canvas(e){let{params:r,search:t}=e,i=await D(r.type,r.slug,{page:t.page,search:t.search});if(i.type!=="list")return;if(t.postIds&&t.postIds.length>0)return{postType:r.type,postId:t.postIds[0].toString(),isPreview:!0};let s=I(i,r.type),n=await(0,L.resolveSelect)(E.store).getEntityRecords("postType",r.type,{...s,per_page:1});if(n&&n.length>0)return{postType:r.type,postId:n[0].id.toString(),isPreview:!0}}};export{pe as route};
