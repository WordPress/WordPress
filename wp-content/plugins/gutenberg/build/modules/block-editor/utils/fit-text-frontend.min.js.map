{
  "version": 3,
  "sources": ["../../../../packages/block-editor/src/utils/fit-text-frontend.js", "../../../../packages/block-editor/src/utils/fit-text-utils.js"],
  "sourcesContent": ["/**\n * Frontend fit text functionality.\n * Automatically detects and initializes fit text on blocks with the has-fit-text class.\n * Supports both initial page load and Interactivity API client-side navigation.\n */\n\n/**\n * WordPress dependencies\n */\nimport { store, getElement, getContext } from '@wordpress/interactivity';\n\n/**\n * Internal dependencies\n */\nimport { optimizeFitText } from './fit-text-utils';\n\n// Initialize via Interactivity API for client-side navigation\nstore( 'core/fit-text', {\n\tcallbacks: {\n\t\tinit() {\n\t\t\tconst context = getContext();\n\t\t\tconst { ref } = getElement();\n\n\t\t\tconst applyFontSize = ( fontSize ) => {\n\t\t\t\tif ( fontSize === 0 ) {\n\t\t\t\t\tref.style.fontSize = '';\n\t\t\t\t} else {\n\t\t\t\t\tref.style.fontSize = `${ fontSize }px`;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// Initial fit text optimization.\n\t\t\tcontext.fontSize = optimizeFitText( ref, applyFontSize );\n\n\t\t\t// Starts ResizeObserver to handle dynamic resizing.\n\t\t\tif ( window.ResizeObserver && ref.parentElement ) {\n\t\t\t\tconst resizeObserver = new window.ResizeObserver( () => {\n\t\t\t\t\tcontext.fontSize = optimizeFitText( ref, applyFontSize );\n\t\t\t\t} );\n\t\t\t\tresizeObserver.observe( ref.parentElement );\n\t\t\t\tresizeObserver.observe( ref );\n\n\t\t\t\t// Return cleanup function to be called when element is removed.\n\t\t\t\treturn () => {\n\t\t\t\t\tif ( resizeObserver ) {\n\t\t\t\t\t\tresizeObserver.disconnect();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t},\n\t},\n} );\n", "/**\n * Shared utility functions for fit text functionality.\n * Uses callback-based approach for maximum code reuse between editor and frontend.\n */\n\n/**\n * Find optimal font size using simple binary search between 5-600px.\n *\n * @param {HTMLElement} textElement   The text element\n * @param {Function}    applyFontSize Function that receives font size in pixels\n * @return {number} Optimal font size\n */\nfunction findOptimalFontSize( textElement, applyFontSize ) {\n\tconst alreadyHasScrollableHeight =\n\t\ttextElement.scrollHeight > textElement.clientHeight;\n\tlet minSize = 5;\n\tlet maxSize = 2400;\n\tlet bestSize = minSize;\n\n\twhile ( minSize <= maxSize ) {\n\t\tconst midSize = Math.floor( ( minSize + maxSize ) / 2 );\n\t\tapplyFontSize( midSize );\n\n\t\tconst fitsWidth = textElement.scrollWidth <= textElement.clientWidth;\n\t\tconst fitsHeight =\n\t\t\talreadyHasScrollableHeight ||\n\t\t\ttextElement.scrollHeight <= textElement.clientHeight;\n\n\t\tif ( fitsWidth && fitsHeight ) {\n\t\t\tbestSize = midSize;\n\t\t\tminSize = midSize + 1;\n\t\t} else {\n\t\t\tmaxSize = midSize - 1;\n\t\t}\n\t}\n\n\treturn bestSize;\n}\n\n/**\n * Complete fit text optimization for a single text element.\n * Handles the full flow using callbacks for font size application.\n *\n * @param {HTMLElement} textElement   The text element (paragraph, heading, etc.)\n * @param {Function}    applyFontSize Function that receives font size in pixels (0 to clear, >0 to apply)\n */\nexport function optimizeFitText( textElement, applyFontSize ) {\n\tif ( ! textElement ) {\n\t\treturn;\n\t}\n\n\tapplyFontSize( 0 );\n\n\tconst optimalSize = findOptimalFontSize( textElement, applyFontSize );\n\n\tapplyFontSize( optimalSize );\n\treturn optimalSize;\n}\n"],
  "mappings": "AASA,OAAS,SAAAA,EAAO,cAAAC,EAAY,cAAAC,MAAkB,2BCG9C,SAASC,EAAqBC,EAAaC,EAAgB,CAC1D,IAAMC,EACLF,EAAY,aAAeA,EAAY,aACpCG,EAAU,EACVC,EAAU,KACVC,EAAWF,EAEf,KAAQA,GAAWC,GAAU,CAC5B,IAAME,EAAU,KAAK,OAASH,EAAUC,GAAY,CAAE,EACtDH,EAAeK,CAAQ,EAEvB,IAAMC,EAAYP,EAAY,aAAeA,EAAY,YACnDQ,EACLN,GACAF,EAAY,cAAgBA,EAAY,aAEpCO,GAAaC,GACjBH,EAAWC,EACXH,EAAUG,EAAU,GAEpBF,EAAUE,EAAU,CAEtB,CAEA,OAAOD,CACR,CASO,SAASI,EAAiBT,EAAaC,EAAgB,CAC7D,GAAK,CAAED,EACN,OAGDC,EAAe,CAAE,EAEjB,IAAMS,EAAcX,EAAqBC,EAAaC,CAAc,EAEpE,OAAAA,EAAeS,CAAY,EACpBA,CACR,CDxCAC,EAAO,gBAAiB,CACvB,UAAW,CACV,MAAO,CACN,IAAMC,EAAUC,EAAW,EACrB,CAAE,IAAAC,CAAI,EAAIC,EAAW,EAErBC,EAAkBC,GAAc,CAChCA,IAAa,EACjBH,EAAI,MAAM,SAAW,GAErBA,EAAI,MAAM,SAAW,GAAIG,CAAS,IAEpC,EAMA,GAHAL,EAAQ,SAAWM,EAAiBJ,EAAKE,CAAc,EAGlD,OAAO,gBAAkBF,EAAI,cAAgB,CACjD,IAAMK,EAAiB,IAAI,OAAO,eAAgB,IAAM,CACvDP,EAAQ,SAAWM,EAAiBJ,EAAKE,CAAc,CACxD,CAAE,EACF,OAAAG,EAAe,QAASL,EAAI,aAAc,EAC1CK,EAAe,QAASL,CAAI,EAGrB,IAAM,CACPK,GACJA,EAAe,WAAW,CAE5B,CACD,CACD,CACD,CACD,CAAE",
  "names": ["store", "getElement", "getContext", "findOptimalFontSize", "textElement", "applyFontSize", "alreadyHasScrollableHeight", "minSize", "maxSize", "bestSize", "midSize", "fitsWidth", "fitsHeight", "optimizeFitText", "optimalSize", "store", "context", "getContext", "ref", "getElement", "applyFontSize", "fontSize", "optimizeFitText", "resizeObserver"]
}
