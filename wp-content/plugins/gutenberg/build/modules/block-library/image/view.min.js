import{store as H,getContext as m,getElement as A,withSyncEvent as x,withScope as N}from"@wordpress/interactivity";var w=200;var v=!1,R=0;function W({uploadedSrc:t}){return t||"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="}function _({lightboxSrcset:t}){return t||""}var{state:e,actions:S,callbacks:B}=H("core/image",{state:{currentImageId:null,preloadTimers:new Map,preloadedImageIds:new Set,get currentImage(){return e.metadata[e.currentImageId]},get overlayOpened(){return e.currentImageId!==null},get roleAttribute(){return e.overlayOpened?"dialog":null},get ariaModal(){return e.overlayOpened?"true":null},get enlargedSrc(){return W(e.currentImage)},get enlargedSrcset(){return _(e.currentImage)},get figureStyles(){return e.overlayOpened&&`${e.currentImage.figureStyles?.replace(/margin[^;]*;?/g,"")};`},get imgStyles(){return e.overlayOpened&&`${e.currentImage.imgStyles?.replace(/;$/,"")}; object-fit:cover;`},get imageButtonRight(){let{imageId:t}=m();return e.metadata[t].imageButtonRight},get imageButtonTop(){let{imageId:t}=m();return e.metadata[t].imageButtonTop},get isContentHidden(){let t=m();return e.overlayEnabled&&e.currentImageId===t.imageId},get isContentVisible(){let t=m();return!e.overlayEnabled&&e.currentImageId===t.imageId}},actions:{showLightbox(){let{imageId:t}=m();e.metadata[t].imageRef?.complete&&(e.scrollTopReset=document.documentElement.scrollTop,e.scrollLeftReset=document.documentElement.scrollLeft,e.overlayEnabled=!0,e.currentImageId=t,B.setOverlayStyles())},hideLightbox(){e.overlayEnabled&&(e.overlayEnabled=!1,setTimeout(function(){e.currentImage.buttonRef.focus({preventScroll:!0}),e.currentImageId=null},450))},handleKeydown:x(t=>{if(e.overlayEnabled){if(t.key==="Tab"){t.preventDefault();let{ref:i}=A();i.querySelector("button").focus()}t.key==="Escape"&&S.hideLightbox()}}),handleTouchMove:x(t=>{e.overlayEnabled&&t.preventDefault()}),handleTouchStart(){v=!0},handleTouchEnd(){R=Date.now(),v=!1},handleScroll(){e.overlayOpened&&!v&&Date.now()-R>450&&window.scrollTo(e.scrollLeftReset,e.scrollTopReset)},preloadImage(){let{imageId:t}=m();if(e.preloadedImageIds.has(t))return;let i=e.metadata[t],a=document.createElement("link");a.rel="preload",a.as="image",a.href=W(i);let c=_(i);c&&(a.setAttribute("imagesrcset",c),a.setAttribute("imagesizes","100vw")),document.head.appendChild(a),e.preloadedImageIds.add(t)},preloadImageWithDelay(){let{imageId:t}=m();S.cancelPreload();let i=setTimeout(N(()=>{S.preloadImage(),e.preloadTimers.delete(t)}),w);e.preloadTimers.set(t,i)},cancelPreload(){let{imageId:t}=m();e.preloadTimers.has(t)&&(clearTimeout(e.preloadTimers.get(t)),e.preloadTimers.delete(t))}},callbacks:{setOverlayStyles(){if(!e.overlayEnabled)return;let{naturalWidth:t,naturalHeight:i,offsetWidth:a,offsetHeight:c}=e.currentImage.imageRef,{x:p,y:I}=e.currentImage.imageRef.getBoundingClientRect(),g=t/i,s=a/c;if(e.currentImage.scaleAttr==="contain")if(g>s){let d=a/g;I+=(c-d)/2,c=d}else{let d=c*g;p+=(a-d)/2,a=d}s=a/c;let r=parseFloat(e.currentImage.targetWidth!=="none"?e.currentImage.targetWidth:t),n=parseFloat(e.currentImage.targetHeight!=="none"?e.currentImage.targetHeight:i),u=r/n,h=r,f=n,l=r,o=n;if(g.toFixed(2)!==u.toFixed(2)){if(g>u){let d=r/g;n-d>r?(n=d,r=d*g):n=r/g}else{let d=n*g;r-d>n?(r=d,n=d/g):r=n*g}l=r,o=n,u=r/n,s>u?(h=r,f=h/s):(f=n,h=f*s)}(a>l||c>o)&&(l=a,o=c);let E=0;window.innerWidth>480?E=80:window.innerWidth>1920&&(E=160);let T=80,b=Math.min(window.innerWidth-E,l),y=Math.min(window.innerHeight-T,o),D=b/y;s>D?(l=b,o=l/s):(o=y,l=o*s);let O=a/l,M=r*(l/h),L=n*(o/f);e.overlayStyles=`
					--wp--lightbox-initial-top-position: ${I}px;
					--wp--lightbox-initial-left-position: ${p}px;
					--wp--lightbox-container-width: ${l+1}px;
					--wp--lightbox-container-height: ${o+1}px;
					--wp--lightbox-image-width: ${M}px;
					--wp--lightbox-image-height: ${L}px;
					--wp--lightbox-scale: ${O};
					--wp--lightbox-scrollbar-width: ${window.innerWidth-document.documentElement.clientWidth}px;
				`},setButtonStyles(){let{ref:t}=A();if(!t)return;let{imageId:i}=m();e.metadata[i].imageRef=t,e.metadata[i].currentSrc=t.currentSrc;let{naturalWidth:a,naturalHeight:c,offsetWidth:p,offsetHeight:I}=t;if(a===0||c===0)return;let g=t.parentElement,s=t.parentElement.clientWidth,r=t.parentElement.clientHeight,n=g.querySelector("figcaption");if(n){let o=window.getComputedStyle(n);["absolute","fixed"].includes(o.position)||(r=r-n.offsetHeight-parseFloat(o.marginTop)-parseFloat(o.marginBottom))}let u=r-I,h=s-p,f=u+16,l=h+16;if(e.metadata[i].scaleAttr==="contain"){let o=a/c,E=p/I;if(o>=E){let T=p/o;f=(I-T)/2+u+16,l=h+16}else{let T=I*o;f=u+16,l=(p-T)/2+h+16}}e.metadata[i].imageButtonTop=f,e.metadata[i].imageButtonRight=l},setOverlayFocus(){if(e.overlayEnabled){let{ref:t}=A();t.focus()}},initTriggerButton(){let{imageId:t}=m(),{ref:i}=A();e.metadata[t].buttonRef=i}}},{lock:!0});
//# sourceMappingURL=view.min.js.map
