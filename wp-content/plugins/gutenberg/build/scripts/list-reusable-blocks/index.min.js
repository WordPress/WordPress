var wp;(wp||={}).listReusableBlocks=(()=>{var ie=Object.create;var F=Object.defineProperty;var ae=Object.getOwnPropertyDescriptor;var se=Object.getOwnPropertyNames;var ce=Object.getPrototypeOf,ue=Object.prototype.hasOwnProperty;var u=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var le=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of se(e))!ue.call(r,o)&&o!==t&&F(r,o,{get:()=>e[o],enumerable:!(n=ae(e,o))||n.enumerable});return r};var i=(r,e,t)=>(t=r!=null?ie(ce(r)):{},le(e||!r||!r.__esModule?F(t,"default",{value:r,enumerable:!0}):t,r));var T=u((be,L)=>{L.exports=window.wp.element});var h=u((he,k)=>{k.exports=window.wp.i18n});var C=u((Ie,z)=>{z.exports=window.wp.apiFetch});var Z=u((Re,G)=>{G.exports=window.wp.blob});var R=u((Ae,V)=>{V.exports=window.wp.compose});var D=u((Fe,H)=>{H.exports=window.wp.components});var v=u((Je,Q)=>{Q.exports=window.ReactJSXRuntime});var S=i(T()),oe=i(h());var m=function(){return m=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},m.apply(this,arguments)};function B(r){return r.toLowerCase()}var fe=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],pe=/[^A-Z0-9]+/gi;function M(r,e){e===void 0&&(e={});for(var t=e.splitRegexp,n=t===void 0?fe:t,o=e.stripRegexp,a=o===void 0?pe:o,s=e.transform,c=s===void 0?B:s,p=e.delimiter,j=p===void 0?" ":p,d=J(J(r,n,"$1\0$2"),a,"\0"),w=0,_=d.length;d.charAt(w)==="\0";)w++;for(;d.charAt(_-1)==="\0";)_--;return d.slice(w,_).split("\0").map(c).join(j)}function J(r,e,t){return e instanceof RegExp?r.replace(e,t):e.reduce(function(n,o){return n.replace(o,t)},r)}function $(r,e){return e===void 0&&(e={}),M(r,m({delimiter:"."},e))}function U(r,e){return e===void 0&&(e={}),$(r,m({delimiter:"-"},e))}var I=i(C()),q=i(Z());async function de(r){let e=await(0,I.default)({path:"/wp/v2/types/wp_block"}),t=await(0,I.default)({path:`/wp/v2/${e.rest_base}/${r}?context=edit`}),n=t.title.raw,o=t.content.raw,a=t.wp_pattern_sync_status,s=JSON.stringify({__file:"wp_block",title:n,content:o,syncStatus:a},null,2),c=U(n)+".json";(0,q.downloadBlob)(c,s,"application/json")}var X=de;var te=i(R()),re=i(h()),O=i(D());var y=i(T()),Y=i(R()),l=i(h()),g=i(D());var N=i(C());function K(r){let e=new window.FileReader;return new Promise(t=>{e.onload=()=>{t(e.result)},e.readAsText(r)})}async function me(r){let e=await K(r),t;try{t=JSON.parse(e)}catch{throw new Error("Invalid JSON file")}if(t.__file!=="wp_block"||!t.title||!t.content||typeof t.title!="string"||typeof t.content!="string"||t.syncStatus&&typeof t.syncStatus!="string")throw new Error("Invalid pattern JSON file");let n=await(0,N.default)({path:"/wp/v2/types/wp_block"});return await(0,N.default)({path:`/wp/v2/${n.rest_base}`,data:{title:t.title,content:t.content,status:"publish",meta:t.syncStatus==="unsynced"?{wp_pattern_sync_status:t.syncStatus}:void 0},method:"POST"})}var W=me;var f=i(v());function ye({instanceId:r,onUpload:e}){let t="list-reusable-blocks-import-form-"+r,n=(0,y.useRef)(),[o,a]=(0,y.useState)(!1),[s,c]=(0,y.useState)(null),[p,j]=(0,y.useState)(null),d=E=>{j(E.target.files[0]),c(null)},w=E=>{E.preventDefault(),p&&(a({isLoading:!0}),W(p).then(P=>{n&&(a(!1),e(P))}).catch(P=>{if(!n)return;let b;switch(P.message){case"Invalid JSON file":b=(0,l.__)("Invalid JSON file");break;case"Invalid pattern JSON file":b=(0,l.__)("Invalid pattern JSON file");break;default:b=(0,l.__)("Unknown error")}a(!1),c(b)}))},_=()=>{c(null)};return(0,f.jsxs)("form",{className:"list-reusable-blocks-import-form",onSubmit:w,ref:n,children:[s&&(0,f.jsx)(g.Notice,{status:"error",onRemove:()=>_(),children:s}),(0,f.jsx)("label",{htmlFor:t,className:"list-reusable-blocks-import-form__label",children:(0,l.__)("File")}),(0,f.jsx)("input",{id:t,type:"file",onChange:d}),(0,f.jsx)(g.Button,{__next40pxDefaultSize:!0,type:"submit",isBusy:o,accessibleWhenDisabled:!0,disabled:!p||o,variant:"secondary",className:"list-reusable-blocks-import-form__button",children:(0,l._x)("Import","button label")})]})}var ee=(0,Y.withInstanceId)(ye);var x=i(v());function we({onUpload:r}){return(0,x.jsx)(O.Dropdown,{popoverProps:{placement:"bottom-start"},contentClassName:"list-reusable-blocks-import-dropdown__content",renderToggle:({isOpen:e,onToggle:t})=>(0,x.jsx)(O.Button,{size:"compact",className:"list-reusable-blocks-import-dropdown__button","aria-expanded":e,onClick:t,variant:"primary",children:(0,re.__)("Import from JSON")}),renderContent:({onClose:e})=>(0,x.jsx)(ee,{onUpload:(0,te.pipe)(e,r)})})}var ne=we;var A=i(v());document.body.addEventListener("click",r=>{r.target.classList.contains("wp-list-reusable-blocks__export")&&(r.preventDefault(),X(r.target.dataset.id))});document.addEventListener("DOMContentLoaded",()=>{let r=document.querySelector(".page-title-action");if(!r)return;let e=()=>{let n=document.createElement("div");n.className="notice notice-success is-dismissible",n.innerHTML=`<p>${(0,oe.__)("Pattern imported successfully!")}</p>`;let o=document.querySelector(".wp-header-end");o&&o.parentNode.insertBefore(n,o)},t=document.createElement("div");t.className="list-reusable-blocks__container",r.parentNode.insertBefore(t,r),(0,S.createRoot)(t).render((0,A.jsx)(S.StrictMode,{children:(0,A.jsx)(ne,{onUpload:e})}))});})();
//# sourceMappingURL=index.min.js.map
